# Use nvim
export GIT_EDITOR="nvim"
export EDITOR="nvim"

# Extend PATH
export PATH="$HOME/.local/bin:$PATH"
_texlive_bin=$(ls -d /usr/local/texlive/*/bin/$(uname -m)-linux 2>/dev/null | sort | tail -1)
[ -n "$_texlive_bin" ] && export PATH="$_texlive_bin:$PATH"
unset _texlive_bin
export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"

# Check if mise is installed; if so, activate it
if command -v mise >/dev/null 2>&1; then
  eval "$(mise activate bash)"
fi

# Check if terraform is installed; if so, install autocomplete
if command -v terraform >/dev/null 2>&1; then
  complete -C "$(command -v terraform)" terraform
fi

# Check if kubernetes is installed; if so, install autocomplete
if command -v kubectl help &> /dev/null
then
  source <(kubectl completion bash)
  complete -o default -F __start_kubectl k
fi

# Source secret environment variables
if [ -f $HOME/.secretenv ]; then
    source $HOME/.secretenv
fi

# I don't want to assume all of my roles are executed on every target so I source most things by putting them in a
# dedicated directory. This way, I can have each tool manage its own sourcing.
if [ -d "$HOME/.sources.d" ]; then
  for f in "$HOME/.sources.d"/*.sh; do
    [ -r "$f" ] && . "$f"
  done
fi

echo " > .bashrc_sources sourced"
